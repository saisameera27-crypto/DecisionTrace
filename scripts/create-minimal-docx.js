// Simple script to create a minimal DOCX file for testing
// DOCX files are ZIP archives with XML files inside
const fs = require('fs');
const path = require('path');

// Minimal DOCX structure (simplified)
// This creates a basic DOCX that mammoth can parse
const minimalDocx = Buffer.from([
  // ZIP Local File Header
  0x50, 0x4B, 0x03, 0x04, 0x14, 0x00, 0x00, 0x00,
  0x08, 0x00, 0x00, 0x00, 0x21, 0x00,
  // Filename: [Content_Types].xml
  0x5B, 0x43, 0x6F, 0x6E, 0x74, 0x65, 0x6E, 0x74, 0x5F, 0x54, 0x79, 0x70, 0x65, 0x73, 0x5D, 0x2E, 0x78, 0x6D, 0x6C,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  // Minimal XML content
  0x3C, 0x3F, 0x78, 0x6D, 0x6C, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E, 0x3D, 0x22, 0x31, 0x2E, 0x30, 0x22, 0x3F, 0x3E
]);

const fixtureDir = path.join(__dirname, '../tests/fixtures');
if (!fs.existsSync(fixtureDir)) {
  fs.mkdirSync(fixtureDir, { recursive: true });
}

const outputPath = path.join(fixtureDir, 'minimal-test.docx');
fs.writeFileSync(outputPath, minimalDocx);
console.log(`Created minimal DOCX fixture at: ${outputPath}`);
